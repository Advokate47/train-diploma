{"ast":null,"code":"import _slicedToArray from \"/Users/ksenialasenko/Desktop/gitHub/train-master/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/ksenialasenko/Desktop/gitHub/train-master/src/js/PassengersPage.js\";\nimport React, { useRef, useState, Fragment, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { TripDetails } from './TripDetails';\nimport MaskedInput from './MaskedInput';\nimport { Datepicker } from './Datepicker';\n\nvar PassengersPage = function PassengersPage(props) {\n  if (props.location.passengers) {\n    sessionStorage.passengers = JSON.stringify(props.location.passengers);\n    sessionStorage.seats = JSON.stringify(props.location.seats);\n    sessionStorage.price = props.location.price;\n  }\n\n  var passengers = props.location.passengers || JSON.parse(sessionStorage.passengers);\n  var price = props.location.price || JSON.parse(sessionStorage.price);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      valid = _useState2[0],\n      _setValid = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      passengersList = _useState4[0],\n      setPassengersList = _useState4[1];\n\n  var savePassengers = function savePassengers(passenger) {\n    var passengers = passengersList.slice();\n    passengers.push(passenger);\n    setPassengersList(passengers);\n  };\n\n  return React.createElement(\"div\", {\n    className: \"columns\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29\n    },\n    __self: this\n  }, React.createElement(TripDetails, {\n    props: props,\n    passengers: passengers,\n    price: price,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"col-right\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32\n    },\n    __self: this\n  }, new Array(passengers.adults).fill('').map(function (p, i) {\n    return React.createElement(PassengerCard, {\n      passenger: i + 1,\n      open: i > 0 ? false : true,\n      adult: true,\n      setValid: function setValid(i) {\n        return _setValid(i);\n      },\n      valid: valid,\n      setPassengers: function setPassengers(passenger) {\n        return savePassengers(passenger);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 35\n      },\n      __self: this\n    });\n  }), new Array(passengers.children).fill('').map(function (p, i) {\n    return React.createElement(PassengerCard, {\n      passenger: passengers.adults + 1 + i,\n      open: false,\n      child: true,\n      setValid: function setValid(i) {\n        return _setValid(i);\n      },\n      valid: valid,\n      setPassengers: function setPassengers(passenger) {\n        return savePassengers(passenger);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    });\n  }), React.createElement(Link, {\n    to: \"/payment\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    disabled: valid.length !== passengers.adults + passengers.children,\n    onClick: function onClick() {\n      return sessionStorage.passengersList = JSON.stringify(passengersList);\n    },\n    className: \"to-order-button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }, \"\\u0414\\u0430\\u043B\\u0435\\u0435\"))));\n};\n\nvar PassengerCard = function PassengerCard(_ref) {\n  var open = _ref.open,\n      passenger = _ref.passenger,\n      child = _ref.child,\n      adult = _ref.adult,\n      valid = _ref.valid,\n      setValid = _ref.setValid,\n      setPassengers = _ref.setPassengers;\n\n  var _useState5 = useState(open),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isOpen = _useState6[0],\n      setOpen = _useState6[1];\n\n  var formRef = useRef(null);\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      lastName = _useState8[0],\n      setLastName = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      firstName = _useState10[0],\n      setFirstName = _useState10[1];\n\n  var _useState11 = useState(''),\n      _useState12 = _slicedToArray(_useState11, 2),\n      patronymic = _useState12[0],\n      setPatronymic = _useState12[1];\n\n  var _useState13 = useState(null),\n      _useState14 = _slicedToArray(_useState13, 2),\n      dateOfBirth = _useState14[0],\n      setDateOfBirth = _useState14[1];\n\n  var _useState15 = useState('мужской'),\n      _useState16 = _slicedToArray(_useState15, 2),\n      gender = _useState16[0],\n      setGender = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      disabilities = _useState18[0],\n      setDisabilities = _useState18[1];\n\n  var _useState19 = useState(''),\n      _useState20 = _slicedToArray(_useState19, 2),\n      passport1 = _useState20[0],\n      setPassport1 = _useState20[1];\n\n  var _useState21 = useState(''),\n      _useState22 = _slicedToArray(_useState21, 2),\n      passport2 = _useState22[0],\n      setPassport2 = _useState22[1];\n\n  var _useState23 = useState(''),\n      _useState24 = _slicedToArray(_useState23, 2),\n      certificate = _useState24[0],\n      setCertificate = _useState24[1];\n\n  var _useState25 = useState(adult),\n      _useState26 = _slicedToArray(_useState25, 2),\n      isPassportChosen = _useState26[0],\n      setIsPassportChosen = _useState26[1];\n\n  var handleInput = function handleInput(event) {\n    var value = event.target.value;\n\n    if (value.match(/[^А-Яа-яЁё -]/g)) {\n      return;\n    }\n\n    switch (event.target.name) {\n      case \"last-name\":\n        setLastName(value);\n        break;\n\n      case \"first-name\":\n        setFirstName(value);\n        break;\n\n      case \"patronymic\":\n        setPatronymic(value);\n        break;\n\n      default:\n        return;\n    }\n  };\n\n  var isNameValid = function isNameValid() {\n    if (firstName.trim().match(/[ ]{2,}|[-]{2,}|[-\\b]/)) {\n      throw new Error(\"Введите корректное имя!\");\n    }\n\n    if (lastName.trim().match(/[ ]{2,}|[-]{2,}|[-\\b]/)) {\n      throw new Error(\"Введите корректную фамилию\");\n    }\n\n    if (patronymic.trim().match(/[ ]{2,}|[-]{2,}|[-\\b]/)) {\n      throw new Error(\"Введите корректное отчество\");\n    }\n  };\n\n  var isPassportValid = function isPassportValid() {\n    if (isPassportChosen) {\n      if (passport1.match(/_/)) {\n        throw new Error(\"Введите 4 цифры серии паспорта\");\n      }\n\n      if (passport2.match(/_/)) {\n        throw new Error(\"Введите 6 цифр номера паспорта\");\n      }\n    } else {\n      if (certificate.match(/_/)) {\n        throw new Error(\"Введите 12 цифр номера свидетельства о рождении\");\n      }\n    }\n  };\n\n  var isValid = function isValid() {\n    try {\n      isNameValid();\n      isPassportValid();\n    } catch (e) {\n      return React.createElement(\"span\", {\n        className: \"error\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, e.message);\n    }\n\n    if (!valid.find(function (el) {\n      return el === passenger;\n    })) {\n      var validated = valid.slice();\n      validated.push(passenger);\n      setValid(validated);\n    }\n\n    return React.createElement(\"span\", {\n      className: \"valid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, \"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E!\");\n  };\n\n  var isPassportComplete = passport1.replace(/\\s|_/g, '').length === 4 && passport2.replace(/\\s|_/g, '').length === 6;\n  var isCertificateComplete = certificate.replace(/\\s|_/g, '').length === 12;\n  var isComplete = firstName && lastName && patronymic && (isPassportComplete || isCertificateComplete) && dateOfBirth;\n  useEffect(function () {\n    if (isComplete) {\n      setPassengers({\n        name: lastName + \" \" + firstName + \" \" + patronymic,\n        gender: \"Пол \" + gender,\n        dateOfBirth: \"Дата рождения \" + dateOfBirth,\n        document: isPassportChosen ? \"Паспорт РФ \" + passport1.replace(/\\s/g, \"\") + passport2.replace(/\\s/g, \"\") : \"Свидетельство о рождении \" + certificate.replace(/\\s/g, \"\"),\n        adult: adult\n      });\n    }\n  }, [isComplete]);\n\n  if (isOpen) {\n    var today = new Date();\n    var minDate = adult ? new Date(today.setYear(today.getFullYear() - 100)) : new Date(today.setYear(today.getFullYear() - 10));\n    return React.createElement(\"div\", {\n      className: \"passengers-card passengers-card_open\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      onClick: function onClick() {\n        return setOpen(!isOpen);\n      },\n      className: \"passengers-card_title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \"\\u041F\\u0430\\u0441\\u0441\\u0430\\u0436\\u0438\\u0440 \", passenger), React.createElement(\"form\", {\n      ref: formRef,\n      action: \"\",\n      className: \"passengers-card_form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, React.createElement(\"fieldset\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"select-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(\"select\", {\n      defaultValue: adult ? \"adult\" : \"child\",\n      className: \"passengers-card_select\",\n      name: \"\",\n      id: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      disabled: child,\n      value: \"adult\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, \"\\u0412\\u0437\\u0440\\u043E\\u0441\\u043B\\u044B\\u0439\"), React.createElement(\"option\", {\n      disabled: adult,\n      value: \"child\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, \"\\u0414\\u0435\\u0442\\u0441\\u043A\\u0438\\u0439\"))), React.createElement(\"div\", {\n      className: \"personal-details\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"last-name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, \"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\", React.createElement(\"input\", {\n      value: lastName,\n      onChange: handleInput,\n      type: \"text\",\n      name: \"last-name\",\n      className: \"passengers-card_last-name\",\n      id: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      for: \"first-name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, \"\\u0418\\u043C\\u044F\", React.createElement(\"input\", {\n      value: firstName,\n      onChange: handleInput,\n      type: \"text\",\n      name: \"first-name\",\n      className: \"passengers-card_name\",\n      id: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      for: \"patronymic\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, \"\\u041E\\u0442\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\", React.createElement(\"input\", {\n      value: patronymic,\n      onChange: handleInput,\n      type: \"text\",\n      name: \"patronymic\",\n      className: \"passengers-card_patronymic-name\",\n      id: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"personal-details\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"gender_label\",\n      for: \"gender\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"\\u041F\\u043E\\u043B \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      onChange: function onChange() {\n        return setGender(\"мужской\");\n      },\n      defaultChecked: true,\n      value: \"\\u041C\",\n      type: \"radio\",\n      className: \"gender\",\n      name: \"gender\",\n      id: \"gender\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      onChange: function onChange() {\n        return setGender(\"женский\");\n      },\n      value: \"\\u0416\",\n      type: \"radio\",\n      className: \"gender\",\n      name: \"gender\",\n      id: \"gender\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      className: \"birth-picker\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, \"\\u0414\\u0430\\u0442\\u0430 \\u0440\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F\", React.createElement(Datepicker, {\n      minDate: minDate,\n      minDateMessage: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043A\\u043E\\u0440\\u0440\\u0435\\u043A\\u0442\\u043D\\u0443\\u044E \\u0434\\u0430\\u0442\\u0443 \\u0440\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F\",\n      disableFuture: true,\n      adornment: {\n        style: {\n          display: \"none\"\n        }\n      },\n      defaultDate: null,\n      onDateSelect: function onDateSelect(date) {\n        return setDateOfBirth(date.toLocaleDateString());\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"disabilities-check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      checked: disabilities,\n      onChange: function onChange() {\n        return setDisabilities(!disabilities);\n      },\n      type: \"checkbox\",\n      id: \"disabilities\",\n      className: \"disabilities\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      for: \"disabilities\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, \"\\u043E\\u0433\\u0440\\u0430\\u043D\\u0438\\u0447\\u0435\\u043D\\u043D\\u0430\\u044F \\u043F\\u043E\\u0434\\u0432\\u0438\\u0436\\u043D\\u043E\\u0441\\u0442\\u044C\"))), React.createElement(\"fieldset\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"select-label\",\n      for: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, \"\\u0422\\u0438\\u043F \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430\", React.createElement(\"select\", {\n      defaultValue: adult ? \"паспорт\" : \"свидетельство\",\n      onChange: function onChange() {\n        return setIsPassportChosen(!isPassportChosen);\n      },\n      name: \"\",\n      id: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"\\u043F\\u0430\\u0441\\u043F\\u043E\\u0440\\u0442\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \"\\u041F\\u0430\\u0441\\u043F\\u043E\\u0440\\u0442\"), React.createElement(\"option\", {\n      disabled: adult,\n      value: \"\\u0441\\u0432\\u0438\\u0434\\u0435\\u0442\\u0435\\u043B\\u044C\\u0441\\u0442\\u0432\\u043E\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, \"\\u0421\\u0432\\u0438\\u0434\\u0435\\u0442\\u0435\\u043B\\u044C\\u0441\\u0442\\u0432\\u043E \\u043E \\u0440\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u0438\"))), adult ? React.createElement(Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      for: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, \"\\u0421\\u0435\\u0440\\u0438\\u044F\", React.createElement(MaskedInput, {\n      value: passport1,\n      onChange: function onChange(value) {\n        return setPassport1(value);\n      },\n      inputmask: [/\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      for: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, \"\\u041D\\u043E\\u043C\\u0435\\u0440\", React.createElement(MaskedInput, {\n      value: passport2,\n      onChange: function onChange(value) {\n        return setPassport2(value);\n      },\n      inputmask: [/\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }))) : React.createElement(\"label\", {\n      for: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, \"\\u041D\\u043E\\u043C\\u0435\\u0440\", React.createElement(MaskedInput, {\n      value: certificate,\n      onChange: function onChange(value) {\n        return setCertificate(value);\n      },\n      inputmask: [/\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    })))), React.createElement(\"fieldset\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, firstName && lastName && patronymic && (passport1 && passport2 || certificate) && dateOfBirth ? React.createElement(\"output\", {\n      className: \"error\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, isValid()) : React.createElement(\"output\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"warning\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, \"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0437\\u0430\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435 \\u0432\\u0441\\u0435 \\u043F\\u043E\\u043B\\u044F \\u0444\\u043E\\u0440\\u043C\\u044B!\")))));\n  } else {\n    return React.createElement(\"div\", {\n      className: \"passengers-card \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      onClick: function onClick() {\n        return setOpen(!isOpen);\n      },\n      className: \"passengers-card_title \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, \"\\u041F\\u0430\\u0441\\u0441\\u0430\\u0436\\u0438\\u0440 \", passenger));\n  }\n};\n\nexport { PassengersPage };","map":{"version":3,"sources":["/Users/ksenialasenko/Desktop/gitHub/train-master/src/js/PassengersPage.js"],"names":["React","useRef","useState","Fragment","useEffect","Link","TripDetails","MaskedInput","Datepicker","PassengersPage","props","location","passengers","sessionStorage","JSON","stringify","seats","price","parse","valid","setValid","passengersList","setPassengersList","savePassengers","passenger","slice","push","Array","adults","fill","map","p","i","children","length","PassengerCard","open","child","adult","setPassengers","isOpen","setOpen","formRef","lastName","setLastName","firstName","setFirstName","patronymic","setPatronymic","dateOfBirth","setDateOfBirth","gender","setGender","disabilities","setDisabilities","passport1","setPassport1","passport2","setPassport2","certificate","setCertificate","isPassportChosen","setIsPassportChosen","handleInput","event","value","target","match","name","isNameValid","trim","Error","isPassportValid","isValid","e","message","find","el","validated","isPassportComplete","replace","isCertificateComplete","isComplete","document","today","Date","minDate","setYear","getFullYear","style","display","date","toLocaleDateString"],"mappings":"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","sourcesContent":["import React, { useRef, useState, Fragment, useEffect } from 'react';\nimport {Link} from 'react-router-dom';\nimport { TripDetails } from './TripDetails';\nimport MaskedInput from './MaskedInput';\nimport {Datepicker} from './Datepicker';\n\nconst PassengersPage = (props) => {\n  \n  if (props.location.passengers) {\n    sessionStorage.passengers = JSON.stringify(props.location.passengers);\n    sessionStorage.seats = JSON.stringify(props.location.seats);\n    sessionStorage.price = props.location.price;\n  }\n\n  const passengers = props.location.passengers || JSON.parse(sessionStorage.passengers);\n  const price = props.location.price || JSON.parse(sessionStorage.price);\n  \n  const [valid, setValid] = useState([]);\n  const [passengersList, setPassengersList] = useState([])\n\n  const savePassengers = passenger => {\n    const passengers = passengersList.slice();\n    passengers.push(passenger);\n    setPassengersList(passengers);\n  }\n  \n  return (\n    <div className=\"columns\">\n      <div className=\"col-left\">\n        <TripDetails props={props} passengers={passengers} price={price}/>\n      </div>\n      <div className=\"col-right\">\n        {(new Array(passengers.adults))\n            .fill('')\n            .map((p, i) => <PassengerCard \n                              passenger={i + 1} \n                              open={i > 0 ? false : true} \n                              adult \n                              setValid={(i) => setValid(i)} \n                              valid={valid}\n                              setPassengers={(passenger) => savePassengers(passenger)}/>)}\n\n        {(new Array(passengers.children))\n              .fill('')\n              .map((p, i) => <PassengerCard \n                              passenger={passengers.adults + 1 + i} \n                              open={false} \n                              child \n                              setValid={(i) => setValid(i)} \n                              valid={valid}\n                              setPassengers={(passenger) => savePassengers(passenger)}/>)}\n\n        <Link to='/payment' >\n          <button disabled={valid.length !== passengers.adults + passengers.children}  onClick={() => sessionStorage.passengersList = JSON.stringify(passengersList)} className=\"to-order-button\">Далее</button>\n        </Link>\n      </div>\n    </div>\n  )\n}\n\n\nconst PassengerCard = ({open, passenger, child, adult, valid, setValid, setPassengers}) => {\n  const [isOpen, setOpen] = useState(open);\n  let formRef = useRef(null);\n\n  const [lastName, setLastName] = useState('');\n  const [firstName, setFirstName] = useState('');\n  const [patronymic, setPatronymic] = useState('');\n  const [dateOfBirth, setDateOfBirth] = useState(null);\n  const [gender, setGender] = useState('мужской');\n  const [disabilities, setDisabilities] = useState(false);\n  const [passport1, setPassport1] = useState('');\n  const [passport2, setPassport2] = useState('');\n  const [certificate, setCertificate] = useState('');\n  const [isPassportChosen, setIsPassportChosen] = useState(adult);\n \n  const handleInput = event => {\n    const value = event.target.value;\n    if (value.match(/[^А-Яа-яЁё -]/g)) {\n      return;\n    }\n    switch(event.target.name) {\n      case \"last-name\":\n        setLastName(value);\n        break;\n      case \"first-name\":\n        setFirstName(value);\n        break;\n      case \"patronymic\": \n        setPatronymic(value);\n        break;\n      default: \n        return;\n    }\n  }\n\n  const isNameValid = () => {\n    if (firstName.trim().match(/[ ]{2,}|[-]{2,}|[-\\b]/)) {\n      throw new Error(\"Введите корректное имя!\")\n    }\n    if (lastName.trim().match(/[ ]{2,}|[-]{2,}|[-\\b]/)) {\n      throw new Error(\"Введите корректную фамилию\")\n    }\n    if (patronymic.trim().match(/[ ]{2,}|[-]{2,}|[-\\b]/)) {\n      throw new Error(\"Введите корректное отчество\")\n    }\n  }\n\n  const isPassportValid = () => {\n    if (isPassportChosen) {\n      if (passport1.match(/_/)) {\n        throw new Error (\"Введите 4 цифры серии паспорта\")\n      }\n      if (passport2.match(/_/)) {\n        throw new Error (\"Введите 6 цифр номера паспорта\")\n      }\n    } else {\n      if (certificate.match(/_/)) {\n        throw new Error (\"Введите 12 цифр номера свидетельства о рождении\")\n      }\n    }\n  }\n\n  const isValid = () => {\n    try {\n      isNameValid();\n      isPassportValid();\n    } catch (e) {\n      return <span className=\"error\">{e.message}</span>;\n    }\n    if (!valid.find(el => el === passenger)) {\n      const validated = valid.slice();\n      validated.push(passenger);\n      setValid(validated);\n    }\n    return <span className=\"valid\">Готово!</span>;\n  }\n\n  const isPassportComplete = passport1.replace(/\\s|_/g, '').length === 4 && passport2.replace(/\\s|_/g, '').length === 6;\n  const isCertificateComplete = certificate.replace(/\\s|_/g, '').length === 12;\n  const isComplete = firstName && lastName && patronymic && (isPassportComplete || isCertificateComplete) && dateOfBirth;\n\n  useEffect(() => {\n    if (isComplete) {\n      setPassengers({\n      name: lastName + \" \" + firstName + \" \" + patronymic,\n      gender: \"Пол \" + gender,\n      dateOfBirth: \"Дата рождения \" + dateOfBirth,\n      document: isPassportChosen ? \n                \"Паспорт РФ \" + passport1.replace(/\\s/g, \"\") + passport2.replace(/\\s/g, \"\") : \n                \"Свидетельство о рождении \" + certificate.replace(/\\s/g, \"\"),\n      adult: adult\n    })\n  }\n  },  [isComplete]);\n \n  if (isOpen) {\n    const today = new Date();\n    const minDate = adult ? new Date(today.setYear(today.getFullYear() - 100)) : new Date(today.setYear(today.getFullYear() - 10));\n    \n    return (\n      <div className=\"passengers-card passengers-card_open\">\n        <div onClick={() => setOpen(!isOpen)} className=\"passengers-card_title\">Пассажир {passenger}</div>\n        <form ref={formRef} action=\"\" className=\"passengers-card_form\">\n        <fieldset>\n          <div className=\"select-container\">\n            <select defaultValue={adult ? \"adult\" : \"child\"} className=\"passengers-card_select\" name=\"\" id=\"\">\n              <option disabled={child} value=\"adult\">Взрослый</option>\n              <option disabled={adult} value=\"child\">Детский</option>\n            </select>\n          </div>\n          <div className=\"personal-details\">\n            <label for=\"last-name\">Фамилия\n              <input value={lastName} onChange={handleInput}  type=\"text\" name=\"last-name\" className=\"passengers-card_last-name\" id=\"\"/>\n            </label>\n            <label for=\"first-name\">Имя\n              <input value={firstName} onChange={handleInput} type=\"text\" name=\"first-name\" className=\"passengers-card_name\" id=\"\"/>\n            </label>\n            <label for=\"patronymic\">Отчество\n              <input value={patronymic} onChange={handleInput} type=\"text\" name=\"patronymic\" className=\"passengers-card_patronymic-name\" id=\"\"/>\n            </label>\n          </div>\n          <div className=\"personal-details\">\n            <label className=\"gender_label\" for=\"gender\">Пол <br/>\n              <input onChange={() => setGender(\"мужской\")} defaultChecked value=\"М\" type=\"radio\" className=\"gender\" name=\"gender\" id=\"gender\"/>\n              <input onChange={() => setGender(\"женский\")} value=\"Ж\" type=\"radio\" className=\"gender\" name=\"gender\" id=\"gender\"/>\n            </label>\n            <label className=\"birth-picker\">\n              Дата рождения \n              <Datepicker\n                minDate={minDate}\n                minDateMessage=\"Введите корректную дату рождения\"\n                disableFuture\n                adornment={{style: {display: \"none\"}}} \n                defaultDate={null}\n                onDateSelect={(date) => setDateOfBirth(date.toLocaleDateString())}/>\n            </label>\n          </div>\n          <div className=\"disabilities-check\">\n            <input checked={disabilities} onChange={() => setDisabilities(!disabilities)} type=\"checkbox\" id=\"disabilities\" className=\"disabilities\"/>\n            <label for=\"disabilities\">ограниченная подвижность</label>\n          </div>\n        </fieldset>\n\n        <fieldset>\n          <div>\n            <label className=\"select-label\" for=\"\">\n              Тип документа\n              <select defaultValue={adult ? \"паспорт\" : \"свидетельство\"} onChange={() => setIsPassportChosen(!isPassportChosen)}  name=\"\" id=\"\">\n                <option value=\"паспорт\">Паспорт</option>\n                <option disabled={adult} value=\"свидетельство\">Свидетельство о рождении</option>\n              </select>\n            </label>\n            {adult  ? \n              <Fragment>\n                <label for=\"\">\n                Серия\n                <MaskedInput value={passport1} onChange={value => setPassport1(value)} inputmask={[/\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/]}/>\n                </label>\n              <label for=\"\">\n                Номер\n                <MaskedInput value={passport2} onChange={value => setPassport2(value)} inputmask={[/\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/]}/>\n                </label>\n              </Fragment> :\n              <label for=\"\">\n              Номер\n              <MaskedInput value={certificate} onChange={value => setCertificate(value)} inputmask={[/\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/, ' ', /\\d/]}/>\n              </label>\n            }\n          </div>\n        </fieldset>\n\n        <fieldset>\n          {firstName && lastName && patronymic && ((passport1 && passport2) || certificate) && dateOfBirth ? <output className=\"error\">{isValid()}</output> : <output><span className=\"warning\">Пожалуйста, заполните все поля формы!</span></output>}\n          \n        </fieldset>\n      </form>\n      </div>\n    )\n  } else {\n    return (\n      <div className=\"passengers-card \">\n        <div onClick={() => setOpen(!isOpen)}  className=\"passengers-card_title \">Пассажир {passenger}</div>\n      </div>\n    )\n  }\n}\n\nexport {PassengersPage}"]},"metadata":{},"sourceType":"module"}