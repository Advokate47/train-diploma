{"ast":null,"code":"import _slicedToArray from \"/Users/ksenialasenko/Desktop/gitHub/train-master/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/ksenialasenko/Desktop/gitHub/train-master/src/js/SeatsPage.js\";\nimport React, { Fragment, useContext, useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { CurrentTrain } from './CurrentTrain';\nimport { CurrentTrainBack } from './CurrentTrainBack';\nimport { TicketsNumber } from './TicketsNumber';\nimport { CarType } from './CarType';\nimport { CarScheme } from './CarScheme';\nimport { ApiServiceContext } from './context';\nimport { DetailsTrip } from './DetailsTrip';\nimport { LastTickets } from './LastTickets';\nimport { FiltersForm } from './FiltersForm';\n\nvar SeatsPage = function SeatsPage(props) {\n  // console.log(props.currentTrain[0]._id !== props.currentTrain[1]._id);\n  var api = useContext(ApiServiceContext);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      coaches = _useState4[0],\n      setCoaches = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      chosen = _useState6[0],\n      _setChosen = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      totalPrice = _useState8[0],\n      _setTotalPrice = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      currentType = _useState10[0],\n      _setCurrentType = _useState10[1];\n\n  var _useState11 = useState(''),\n      _useState12 = _slicedToArray(_useState11, 2),\n      currentCoach = _useState12[0],\n      _setCurrentCoach = _useState12[1];\n\n  var _useState13 = useState(1),\n      _useState14 = _slicedToArray(_useState13, 2),\n      adultSeats = _useState14[0],\n      _setAdultSeats = _useState14[1];\n\n  var _useState15 = useState(0),\n      _useState16 = _slicedToArray(_useState15, 2),\n      childrenSeats = _useState16[0],\n      _setChildrenSeats = _useState16[1];\n\n  var _useState17 = useState([]),\n      _useState18 = _slicedToArray(_useState17, 2),\n      dataBack = _useState18[0],\n      setDataBack = _useState18[1];\n\n  var _useState19 = useState([]),\n      _useState20 = _slicedToArray(_useState19, 2),\n      coachesBack = _useState20[0],\n      setCoachesBack = _useState20[1];\n\n  var _useState21 = useState([]),\n      _useState22 = _slicedToArray(_useState21, 2),\n      chosenBack = _useState22[0],\n      setChosenBack = _useState22[1];\n\n  var _useState23 = useState(0),\n      _useState24 = _slicedToArray(_useState23, 2),\n      totalPriceBack = _useState24[0],\n      setTotalPriceBack = _useState24[1];\n\n  var _useState25 = useState(''),\n      _useState26 = _slicedToArray(_useState25, 2),\n      currentTypeBack = _useState26[0],\n      setCurrentTypeBack = _useState26[1];\n\n  var _useState27 = useState(''),\n      _useState28 = _slicedToArray(_useState27, 2),\n      currentCoachBack = _useState28[0],\n      setCurrentCoachBack = _useState28[1];\n\n  var _useState29 = useState(1),\n      _useState30 = _slicedToArray(_useState29, 2),\n      adultSeatsBack = _useState30[0],\n      setAdultSeatsBack = _useState30[1];\n\n  var _useState31 = useState(0),\n      _useState32 = _slicedToArray(_useState31, 2),\n      childrenSeatsBack = _useState32[0],\n      setChildrenSeatsBack = _useState32[1];\n\n  var currentTrain = props.currentTrain[0] || JSON.parse(sessionStorage.currentTrain[0]);\n  var id = currentTrain['_id'];\n  var currentTrainBack = props.currentTrain[1] || JSON.parse(sessionStorage.currentTrain[1]);\n  var idBack = currentTrainBack['_id']; // console.log(id);\n  // console.log(idBack);\n\n  useEffect(function () {\n    api.getSeats(id).then(function (response) {\n      setData(response);\n\n      _setCurrentType(response[0].coach.class_type);\n\n      setCoaches(response.filter(function (el) {\n        return el.coach.class_type === response[0].coach.class_type;\n      }));\n\n      _setCurrentCoach(response[0]);\n\n      sessionStorage.trainId = id;\n    });\n    api.getSeats(idBack).then(function (response) {\n      setDataBack(response);\n      setCurrentTypeBack(response[0].coach.class_type);\n      setCoachesBack(response.filter(function (el) {\n        return el.coach.class_type === response[0].coach.class_type;\n      }));\n      setCurrentCoachBack(response[0]);\n      sessionStorage.trainIdBack = idBack;\n    });\n  }, [id, idBack]);\n  return currentType && data ? // <div>\n  React.createElement(\"section\", {\n    className: \"columns\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, React.createElement(FiltersForm, Object.assign({}, props, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  })), React.createElement(LastTickets, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"col-right\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"seats-choice\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"change-train change-train-to\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"change-train_arrow\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"material-icons\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, \"arrow_forward\")), React.createElement(Link, {\n    to: \"/search\",\n    className: \"change-train_button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, \"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0434\\u0440\\u0443\\u0433\\u043E\\u0439 \\u043F\\u043E\\u0435\\u0437\\u0434\")), React.createElement(CurrentTrain, {\n    info: currentTrain,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }), React.createElement(TicketsNumber, {\n    passengers: {\n      adults: adultSeats,\n      children: childrenSeats\n    },\n    setAdultSeats: function setAdultSeats(seats) {\n      return _setAdultSeats(seats);\n    },\n    setChildrenSeats: function setChildrenSeats(seats) {\n      return _setChildrenSeats(seats);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }), React.createElement(CarType, {\n    coaches: data.filter(function (el) {\n      return el.coach.class_type === currentType;\n    }),\n    currentType: currentType,\n    currentCoach: currentCoach,\n    setCurrentType: function setCurrentType(type) {\n      _setCurrentType(type);\n\n      _setChosen([]);\n\n      _setTotalPrice(0);\n    },\n    setCurrentCoach: function setCurrentCoach(coach) {\n      return _setCurrentCoach(coach);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }), currentCoach && React.createElement(CarScheme, {\n    passengers: adultSeats + childrenSeats,\n    type: currentType,\n    coach: currentCoach,\n    topPrice: currentCoach.coach.top_price,\n    bottomPrice: currentCoach.coach.bottom_price,\n    sidePrice: currentCoach.coach.side_price,\n    chosen: chosen,\n    setChosen: function setChosen(seat) {\n      var chosenSeats = chosen.slice();\n      chosenSeats.push(seat);\n\n      _setChosen(chosenSeats);\n    },\n    cancelChosen: function cancelChosen(seat) {\n      var chosenSeats = chosen.slice();\n      var seatToCancel = chosenSeats.findIndex(function (el) {\n        return el.index === seat.index;\n      });\n      chosenSeats.splice(seatToCancel, 1);\n\n      _setChosen(chosenSeats);\n    },\n    setTotalPrice: function setTotalPrice(price) {\n      return setTotalPriceBack(totalPriceBack + price);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"total-price\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, parseInt(totalPriceBack).toLocaleString())), props.currentTrain[0]._id !== props.currentTrain[1]._id ? React.createElement(\"div\", {\n    className: \"seats-choice\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"change-train change-train-from\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"change-train_arrow\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"material-icons\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, \"arrow_back\")), React.createElement(Link, {\n    to: \"/search\",\n    className: \"change-train_button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, \"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0434\\u0440\\u0443\\u0433\\u043E\\u0439 \\u043F\\u043E\\u0435\\u0437\\u0434\")), React.createElement(CurrentTrainBack, {\n    info: currentTrainBack,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }), React.createElement(TicketsNumber, {\n    passengers: {\n      adults: adultSeatsBack,\n      children: childrenSeatsBack\n    },\n    setAdultSeats: function setAdultSeats(seats) {\n      return setAdultSeatsBack(seats);\n    },\n    setChildrenSeats: function setChildrenSeats(seats) {\n      return setChildrenSeatsBack(seats);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }), React.createElement(CarType, {\n    coaches: data.filter(function (el) {\n      return el.coach.class_type === currentType;\n    }),\n    currentType: currentTypeBack,\n    currentCoach: currentCoachBack,\n    setCurrentType: function setCurrentType(type) {\n      _setCurrentType(type);\n\n      _setChosen([]);\n\n      _setTotalPrice(0);\n    },\n    setCurrentCoach: function setCurrentCoach(coach) {\n      return _setCurrentCoach(coach);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }), currentCoachBack && React.createElement(CarScheme, {\n    passengers: adultSeatsBack + childrenSeatsBack,\n    type: currentTypeBack,\n    coach: currentCoachBack,\n    topPrice: currentCoachBack.coach.top_price,\n    bottomPrice: currentCoachBack.coach.bottom_price,\n    sidePrice: currentCoachBack.coach.side_price,\n    chosen: chosen,\n    setChosen: function setChosen(seat) {\n      var chosenSeats = chosen.slice();\n      chosenSeats.push(seat);\n\n      _setChosen(chosenSeats);\n    },\n    cancelChosen: function cancelChosen(seat) {\n      var chosenSeats = chosenBack.slice();\n      var seatToCancel = chosenSeats.findIndex(function (el) {\n        return el.index === seat.index;\n      });\n      chosenSeats.splice(seatToCancel, 1);\n\n      _setChosen(chosenSeats);\n    },\n    setTotalPrice: function setTotalPrice(price) {\n      return _setTotalPrice(totalPrice + price);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"total-price\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, parseInt(totalPrice).toLocaleString())) : false, React.createElement(\"div\", {\n    className: \"to-order-button-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: {\n      pathname: '/passengers',\n      passengers: {\n        adults: adultSeatsBack,\n        children: childrenSeatsBack\n      },\n      seats: chosen,\n      price: totalPriceBack\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"to-order-button\",\n    disabled: chosen.length === 0 || adultSeatsBack + childrenSeatsBack !== chosen.length,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, \"\\u0414\\u0430\\u043B\\u0435\\u0435\"))))) : React.createElement(\"div\", {\n    className: \"loader\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"loader_image\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }));\n};\n\nexport { SeatsPage };","map":{"version":3,"sources":["/Users/ksenialasenko/Desktop/gitHub/train-master/src/js/SeatsPage.js"],"names":["React","Fragment","useContext","useState","useEffect","Link","CurrentTrain","CurrentTrainBack","TicketsNumber","CarType","CarScheme","ApiServiceContext","DetailsTrip","LastTickets","FiltersForm","SeatsPage","props","api","data","setData","coaches","setCoaches","chosen","setChosen","totalPrice","setTotalPrice","currentType","setCurrentType","currentCoach","setCurrentCoach","adultSeats","setAdultSeats","childrenSeats","setChildrenSeats","dataBack","setDataBack","coachesBack","setCoachesBack","chosenBack","setChosenBack","totalPriceBack","setTotalPriceBack","currentTypeBack","setCurrentTypeBack","currentCoachBack","setCurrentCoachBack","adultSeatsBack","setAdultSeatsBack","childrenSeatsBack","setChildrenSeatsBack","currentTrain","JSON","parse","sessionStorage","id","currentTrainBack","idBack","getSeats","then","response","coach","class_type","filter","el","trainId","trainIdBack","adults","children","seats","type","top_price","bottom_price","side_price","seat","chosenSeats","slice","push","seatToCancel","findIndex","index","splice","price","parseInt","toLocaleString","_id","pathname","passengers","length"],"mappings":"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","sourcesContent":["import React, { Fragment, useContext, useState, useEffect } from 'react';\nimport {Link} from 'react-router-dom';\nimport { CurrentTrain } from './CurrentTrain';\nimport { CurrentTrainBack } from './CurrentTrainBack';\nimport { TicketsNumber } from './TicketsNumber'\nimport { CarType } from './CarType';\nimport { CarScheme } from './CarScheme';\nimport {ApiServiceContext} from './context'\nimport { DetailsTrip } from './DetailsTrip';\nimport { LastTickets } from './LastTickets'\nimport { FiltersForm } from './FiltersForm';\n\nconst SeatsPage = (props) => {\n  // console.log(props.currentTrain[0]._id !== props.currentTrain[1]._id);\n  const api = useContext(ApiServiceContext);\n  const [data, setData] = useState([]);\n  const [coaches, setCoaches] = useState([]);\n  const [chosen, setChosen] = useState([]);\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [currentType, setCurrentType] = useState('');\n  const [currentCoach, setCurrentCoach] = useState('');\n  const [adultSeats, setAdultSeats] = useState(1);\n  const [childrenSeats, setChildrenSeats] = useState(0);\n\n\n  const [dataBack, setDataBack] = useState([]);\n  const [coachesBack, setCoachesBack] = useState([]);\n  const [chosenBack, setChosenBack] = useState([]);\n  const [totalPriceBack, setTotalPriceBack] = useState(0);\n  const [currentTypeBack, setCurrentTypeBack] = useState('');\n  const [currentCoachBack, setCurrentCoachBack] = useState('');\n  const [adultSeatsBack, setAdultSeatsBack] = useState(1);\n  const [childrenSeatsBack, setChildrenSeatsBack] = useState(0);\n\n  const currentTrain = props.currentTrain[0] || JSON.parse(sessionStorage.currentTrain[0]);\n  const id = currentTrain['_id'];\n  const currentTrainBack = props.currentTrain[1] || JSON.parse(sessionStorage.currentTrain[1]);\n  const idBack = currentTrainBack['_id'];\n  // console.log(id);\n  // console.log(idBack);\n  \n  useEffect(() => {\n      api.getSeats(id)\n        .then(response => {\n          setData(response);\n          setCurrentType(response[0].coach.class_type);\n          setCoaches(response.filter(el => el.coach.class_type === response[0].coach.class_type));\n          setCurrentCoach(response[0])\n          sessionStorage.trainId = id;\n        })\n\n        api.getSeats(idBack)\n        .then(response => {\n          setDataBack(response);\n          setCurrentTypeBack(response[0].coach.class_type);\n          setCoachesBack(response.filter(el => el.coach.class_type === response[0].coach.class_type));\n          setCurrentCoachBack(response[0])\n          sessionStorage.trainIdBack = idBack;\n        })\n    \n  }, [id, idBack]);\n\n  return currentType &&  data ? (\n    // <div>\n\n       <section className=\"columns\">\n        <div className=\"col-left\">\n          <FiltersForm {...props} />\n          <LastTickets />\n        </div>\n        <div className=\"col-right\">\n          <div className=\"seats-choice\" >\n            <div className=\"change-train change-train-to\">\n              <span className=\"change-train_arrow\">\n                  <i className=\"material-icons\">arrow_forward</i>\n              </span>\n              <Link to=\"/search\" className=\"change-train_button\">Выбрать другой поезд</Link>\n            </div>\n\n            <CurrentTrain info={currentTrain} />\n            <TicketsNumber \n              passengers={{adults: adultSeats, children: childrenSeats}}\n              setAdultSeats={seats => setAdultSeats(seats)}\n              setChildrenSeats={seats => setChildrenSeats(seats)}\n              />\n            <CarType \n              coaches={data.filter(el => el.coach.class_type === currentType)} \n              currentType={currentType} \n              currentCoach={currentCoach}\n              setCurrentType={type => {\n                setCurrentType(type);\n                setChosen([]);\n                setTotalPrice(0);\n              }}\n              setCurrentCoach={coach => setCurrentCoach(coach)}/>\n            {currentCoach && <CarScheme \n              passengers={adultSeats + childrenSeats}\n              type={currentType} \n              coach={currentCoach}\n              topPrice={currentCoach.coach.top_price}\n              bottomPrice={currentCoach.coach.bottom_price}\n              sidePrice={currentCoach.coach.side_price}\n              chosen={chosen}\n              setChosen={seat => {\n                const chosenSeats = chosen.slice();\n                chosenSeats.push(seat);\n                setChosen(chosenSeats);\n              }}\n              cancelChosen={seat => {\n                const chosenSeats = chosen.slice();\n                const seatToCancel = chosenSeats.findIndex(el => el.index === seat.index);\n                chosenSeats.splice(seatToCancel, 1);\n                setChosen(chosenSeats);\n              }}\n              setTotalPrice={price => setTotalPriceBack(totalPriceBack + price)}\n              />}\n            <div className=\"total-price\">{parseInt(totalPriceBack).toLocaleString()}</div>\n          </div>\n\n          {props.currentTrain[0]._id !== props.currentTrain[1]._id ? (\n          <div className=\"seats-choice\" >\n            <div className=\"change-train change-train-from\">\n              <span className=\"change-train_arrow\">\n                  <i className=\"material-icons\">arrow_back</i>\n              </span>\n              <Link to=\"/search\" className=\"change-train_button\">Выбрать другой поезд</Link>\n            </div>\n\n            <CurrentTrainBack info={currentTrainBack} />\n            <TicketsNumber \n              passengers={{adults: adultSeatsBack, children: childrenSeatsBack}}\n              setAdultSeats={seats => setAdultSeatsBack(seats)}\n              setChildrenSeats={seats => setChildrenSeatsBack(seats)}\n              />\n            <CarType \n              coaches={data.filter(el => el.coach.class_type === currentType)} \n              currentType={currentTypeBack} \n              currentCoach={currentCoachBack}\n              setCurrentType={type => {\n                setCurrentType(type);\n                setChosen([]);\n                setTotalPrice(0);\n              }}\n              setCurrentCoach={coach => setCurrentCoach(coach)}/>\n            {currentCoachBack && <CarScheme \n              passengers={adultSeatsBack + childrenSeatsBack}\n              type={currentTypeBack} \n              coach={currentCoachBack}\n              topPrice={currentCoachBack.coach.top_price}\n              bottomPrice={currentCoachBack.coach.bottom_price}\n              sidePrice={currentCoachBack.coach.side_price}\n              chosen={chosen}\n              setChosen={seat => {\n                const chosenSeats = chosen.slice();\n                chosenSeats.push(seat);\n                setChosen(chosenSeats);\n              }}\n              cancelChosen={seat => {\n                const chosenSeats = chosenBack.slice();\n                const seatToCancel = chosenSeats.findIndex(el => el.index === seat.index);\n                chosenSeats.splice(seatToCancel, 1);\n                setChosen(chosenSeats);\n              }}\n              setTotalPrice={price => setTotalPrice(totalPrice + price)}\n              />}\n            <div className=\"total-price\">{parseInt(totalPrice).toLocaleString()}</div>\n          </div>) : false}\n\n          <div className=\"to-order-button-container\">\n            <Link to={{\n              pathname: '/passengers', \n              passengers: {adults: adultSeatsBack, children: childrenSeatsBack},\n              seats: chosen,\n              price: totalPriceBack\n              }}>\n                <button className=\"to-order-button\" \n                  disabled={chosen.length === 0 || adultSeatsBack + childrenSeatsBack !== chosen.length}>Далее</button>\n            </Link>\n          </div>\n        {/* </div> */}\n      </div>\n    </section>\n    ) : <div className=\"loader\"><div className=\"loader_image\"></div></div>\n  \n}\n\nexport {SeatsPage}"]},"metadata":{},"sourceType":"module"}