{"ast":null,"code":"import _slicedToArray from \"/Users/ksenialasenko/Desktop/gitHub/train-master/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/ksenialasenko/Desktop/gitHub/train-master/src/js/SeatsPage.js\";\nimport React, { Fragment, useContext, useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { CurrentTrain } from './CurrentTrain';\nimport { TicketsNumber } from './TicketsNumber';\nimport { CarType } from './CarType';\nimport { CarScheme } from './CarScheme';\nimport { ApiServiceContext } from './context';\n\nvar SeatsPage = function SeatsPage(props) {\n  /* console.log(props); */\n  var api = useContext(ApiServiceContext);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      coaches = _useState4[0],\n      setCoaches = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      chosen = _useState6[0],\n      _setChosen = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      totalPrice = _useState8[0],\n      _setTotalPrice = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      currentType = _useState10[0],\n      _setCurrentType = _useState10[1];\n\n  var _useState11 = useState(''),\n      _useState12 = _slicedToArray(_useState11, 2),\n      currentCoach = _useState12[0],\n      _setCurrentCoach = _useState12[1];\n\n  var _useState13 = useState(1),\n      _useState14 = _slicedToArray(_useState13, 2),\n      adultSeats = _useState14[0],\n      _setAdultSeats = _useState14[1];\n\n  var _useState15 = useState(0),\n      _useState16 = _slicedToArray(_useState15, 2),\n      childrenSeats = _useState16[0],\n      _setChildrenSeats = _useState16[1];\n\n  var currentTrain = props.currentTrain || JSON.parse(sessionStorage.currentTrain);\n  var id = currentTrain['_id'];\n  useEffect(function () {\n    api.getSeats(id).then(function (response) {\n      setData(response);\n\n      _setCurrentType(response[0].coach.class_type);\n\n      setCoaches(response.filter(function (el) {\n        return el.coach.class_type === response[0].coach.class_type;\n      }));\n\n      _setCurrentCoach(response[0]);\n\n      sessionStorage.trainId = id;\n    });\n  }, [id]);\n  return currentType && data ? React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"seats-choice\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"change-train change-train-to\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"change-train_arrow\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"material-icons\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41\n    },\n    __self: this\n  }, \"arrow_forward\")), React.createElement(Link, {\n    to: \"/search\",\n    className: \"change-train_button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }, \"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0434\\u0440\\u0443\\u0433\\u043E\\u0439 \\u043F\\u043E\\u0435\\u0437\\u0434\")), React.createElement(CurrentTrain, {\n    info: currentTrain,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46\n    },\n    __self: this\n  }), React.createElement(TicketsNumber, {\n    passengers: {\n      adults: adultSeats,\n      children: childrenSeats\n    },\n    setAdultSeats: function setAdultSeats(seats) {\n      return _setAdultSeats(seats);\n    },\n    setChildrenSeats: function setChildrenSeats(seats) {\n      return _setChildrenSeats(seats);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }), React.createElement(CarType, {\n    coaches: data.filter(function (el) {\n      return el.coach.class_type === currentType;\n    }),\n    currentType: currentType,\n    currentCoach: currentCoach,\n    setCurrentType: function setCurrentType(type) {\n      _setCurrentType(type);\n\n      _setChosen([]);\n\n      _setTotalPrice(0);\n    },\n    setCurrentCoach: function setCurrentCoach(coach) {\n      return _setCurrentCoach(coach);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }), currentCoach && React.createElement(CarScheme, {\n    passengers: adultSeats + childrenSeats,\n    type: currentType,\n    coach: currentCoach,\n    topPrice: currentCoach.coach.top_price,\n    bottomPrice: currentCoach.coach.bottom_price,\n    sidePrice: currentCoach.coach.side_price,\n    chosen: chosen,\n    setChosen: function setChosen(seat) {\n      var chosenSeats = chosen.slice();\n      chosenSeats.push(seat);\n\n      _setChosen(chosenSeats);\n    },\n    cancelChosen: function cancelChosen(seat) {\n      var chosenSeats = chosen.slice();\n      var seatToCancel = chosenSeats.findIndex(function (el) {\n        return el.index === seat.index;\n      });\n      chosenSeats.splice(seatToCancel, 1);\n\n      _setChosen(chosenSeats);\n    },\n    setTotalPrice: function setTotalPrice(price) {\n      return _setTotalPrice(totalPrice + price);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"total-price\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, parseInt(totalPrice).toLocaleString())), React.createElement(\"div\", {\n    className: \"to-order-button-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: {\n      pathname: '/passengers',\n      passengers: {\n        adults: adultSeats,\n        children: childrenSeats\n      },\n      seats: chosen,\n      price: totalPrice\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"to-order-button\",\n    disabled: chosen.length === 0 || adultSeats + childrenSeats !== chosen.length,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, \"\\u0414\\u0430\\u043B\\u0435\\u0435\")))) : React.createElement(\"div\", {\n    className: \"loader\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"loader_image\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }));\n};\n\nexport { SeatsPage };","map":{"version":3,"sources":["/Users/ksenialasenko/Desktop/gitHub/train-master/src/js/SeatsPage.js"],"names":["React","Fragment","useContext","useState","useEffect","Link","CurrentTrain","TicketsNumber","CarType","CarScheme","ApiServiceContext","SeatsPage","props","api","data","setData","coaches","setCoaches","chosen","setChosen","totalPrice","setTotalPrice","currentType","setCurrentType","currentCoach","setCurrentCoach","adultSeats","setAdultSeats","childrenSeats","setChildrenSeats","currentTrain","JSON","parse","sessionStorage","id","getSeats","then","response","coach","class_type","filter","el","trainId","adults","children","seats","type","top_price","bottom_price","side_price","seat","chosenSeats","slice","push","seatToCancel","findIndex","index","splice","price","parseInt","toLocaleString","pathname","passengers","length"],"mappings":"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","sourcesContent":["import React, { Fragment, useContext, useState, useEffect } from 'react';\nimport {Link} from 'react-router-dom';\nimport { CurrentTrain } from './CurrentTrain';\nimport { TicketsNumber } from './TicketsNumber'\nimport { CarType } from './CarType';\nimport { CarScheme } from './CarScheme';\nimport {ApiServiceContext} from './context'\n\nconst SeatsPage = (props) => {\n  /* console.log(props); */\n  const api = useContext(ApiServiceContext);\n  const [data, setData] = useState([]);\n  const [coaches, setCoaches] = useState([]);\n  const [chosen, setChosen] = useState([]);\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [currentType, setCurrentType] = useState('');\n  const [currentCoach, setCurrentCoach] = useState('');\n  const [adultSeats, setAdultSeats] = useState(1);\n  const [childrenSeats, setChildrenSeats] = useState(0);\n\n  const currentTrain = props.currentTrain || JSON.parse(sessionStorage.currentTrain);\n  const id = currentTrain['_id'];\n  \n  useEffect(() => {\n      api.getSeats(id)\n        .then(response => {\n          setData(response);\n          setCurrentType(response[0].coach.class_type);\n          setCoaches(response.filter(el => el.coach.class_type === response[0].coach.class_type));\n          setCurrentCoach(response[0])\n          sessionStorage.trainId = id;\n        })\n    \n  }, [id]);\n\n  return currentType &&  data ? (\n    <div>\n      <div className=\"seats-choice\" >\n        <div className=\"change-train change-train-to\">\n          <span className=\"change-train_arrow\">\n              <i className=\"material-icons\">arrow_forward</i>\n          </span>\n          <Link to=\"/search\" className=\"change-train_button\">Выбрать другой поезд</Link>\n        </div>\n\n        <CurrentTrain info={currentTrain} />\n        <TicketsNumber \n          passengers={{adults: adultSeats, children: childrenSeats}}\n          setAdultSeats={seats => setAdultSeats(seats)}\n          setChildrenSeats={seats => setChildrenSeats(seats)}\n          />\n        <CarType \n          coaches={data.filter(el => el.coach.class_type === currentType)} \n          currentType={currentType} \n          currentCoach={currentCoach}\n          setCurrentType={type => {\n            setCurrentType(type);\n            setChosen([]);\n            setTotalPrice(0);\n          }}\n          setCurrentCoach={coach => setCurrentCoach(coach)}/>\n        {currentCoach && <CarScheme \n          passengers={adultSeats + childrenSeats}\n          type={currentType} \n          coach={currentCoach}\n          topPrice={currentCoach.coach.top_price}\n          bottomPrice={currentCoach.coach.bottom_price}\n          sidePrice={currentCoach.coach.side_price}\n          chosen={chosen}\n          setChosen={seat => {\n            const chosenSeats = chosen.slice();\n            chosenSeats.push(seat);\n            setChosen(chosenSeats);\n          }}\n          cancelChosen={seat => {\n            const chosenSeats = chosen.slice();\n            const seatToCancel = chosenSeats.findIndex(el => el.index === seat.index);\n            chosenSeats.splice(seatToCancel, 1);\n            setChosen(chosenSeats);\n          }}\n          setTotalPrice={price => setTotalPrice(totalPrice + price)}\n          />}\n        <div className=\"total-price\">{parseInt(totalPrice).toLocaleString()}</div>\n      </div>\n\n      <div className=\"to-order-button-container\">\n        <Link to={{\n          pathname: '/passengers', \n          passengers: {adults: adultSeats, children: childrenSeats},\n          seats: chosen,\n          price: totalPrice\n          }}>\n            <button className=\"to-order-button\" \n              disabled={chosen.length === 0 || adultSeats + childrenSeats !== chosen.length}>Далее</button>\n        </Link>\n      </div>\n    </div>\n    ) : <div className=\"loader\"><div className=\"loader_image\"></div></div>\n  \n}\n\nexport {SeatsPage}"]},"metadata":{},"sourceType":"module"}